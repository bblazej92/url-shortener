

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Introduction &mdash; URL-Shortener 0.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="URL-Shortener 0.1 documentation" href="index.html"/>
        <link rel="next" title="REST API" href="api.html"/>
        <link rel="prev" title="Contents" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> URL-Shortener
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Contents</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#service-requirements">Service requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="#solution">Solution</a></li>
<li class="toctree-l2"><a class="reference internal" href="#scaling-requirements">Scaling requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-to-scale">How to scale</a></li>
<li class="toctree-l2"><a class="reference internal" href="#satisfying-scaling-requirements">Satisfying scaling requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="#why-mongo">Why mongo?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">REST API</a></li>
<li class="toctree-l1"><a class="reference internal" href="running.html">Running and testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="todo.html">TODO</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">URL-Shortener</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Introduction</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/introduction.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h1>
<p><strong>Url-shortener</strong> is a service which enables to generate short links for given original url.</p>
<div class="section" id="service-requirements">
<h2>Service requirements<a class="headerlink" href="#service-requirements" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>given only the original URL, generate a random short URL</li>
<li>given both the original URL and the desired short URL, create the desired short URL or give the user an error if that is not possible (ie. it was already taken)</li>
<li>retrieve the original URL, given a short URL</li>
<li><dl class="first docutils">
<dt>retrieve information about an existing short URL created by the user, including:</dt>
<dd><ul class="first last">
<li>what is the original URL</li>
<li>when the shortening happened</li>
<li>how many times the short URL has been accessed</li>
</ul>
</dd>
</dl>
</li>
<li>see a list of the URLs he/she created and the information detailed in item 4</li>
</ol>
</div>
<div class="section" id="solution">
<h2>Solution<a class="headerlink" href="#solution" title="Permalink to this headline">¶</a></h2>
<p>Slug is generated doing random choice for each of 6 characters from set A-Za-z0-9 what gives us ~57 billions unique
slugs and high collision-resistance. Because of possibility of collision if custom slug was not specified we generate
random slug till we have unique one. When user specify own slug (service requirements 2) we check if it already exists
and if not save it else raise error.</p>
</div>
<div class="section" id="scaling-requirements">
<h2>Scaling requirements<a class="headerlink" href="#scaling-requirements" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>Point 3 from service requirements should be fast</li>
<li>We don`t expire links so we should to be able to store a lot of them</li>
<li>We should be resilient to load spikes as links can be put in social media</li>
<li>We cannot have collision - generating the same slug for different original URLs</li>
<li>We should be able to run normally even if one of machine fail</li>
<li>We should know if everything work well and machines doesn`t have to much load</li>
</ol>
</div>
<div class="section" id="how-to-scale">
<h2>How to scale<a class="headerlink" href="#how-to-scale" title="Permalink to this headline">¶</a></h2>
<p>Using docker compose + docker swarm.
Running production with nginx or AWS load balancer and load balance whole traffic between many servers.
Sharding mongodb to many machines and adding caching layer on servers.</p>
</div>
<div class="section" id="satisfying-scaling-requirements">
<h2>Satisfying scaling requirements<a class="headerlink" href="#satisfying-scaling-requirements" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>Caching layer and indexing mongodb</li>
<li>Mongodb has built in sharding which works well</li>
<li>Auto-scale number of backend servers which handle traffic + have caching layer for fast responses</li>
<li>Using algorithm described in Solution we are collision resistant</li>
<li>Having many servers handling traffic and many shards of mongodb which internally replicate data between shard our infrastructure is NSPOF</li>
<li>Installing Check_MK monitoring and set sending email/sms on any serious warning and failure</li>
<li>Monitoring of response time for views</li>
</ol>
</div>
<div class="section" id="why-mongo">
<h2>Why mongo?<a class="headerlink" href="#why-mongo" title="Permalink to this headline">¶</a></h2>
<p>According to CAP theorem we can have 2 of 3: Consistency, Availability, Partition Tolerance
I think that consistency is more important than availability in this service and mongodb has both
consistency and partition tolerance. What is more mongodb is stable and widely-used db.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="api.html" class="btn btn-neutral float-right" title="REST API" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Contents" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Bartosz Błażejewski.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>